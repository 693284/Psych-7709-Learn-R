
# "psych" Package

## Procedures for Psychological, Psychometric, and Personality Research

## Introduction

A sim.anova is a simulation function that falls under an all incompasing package called "psych." The sim.anova function enables one to simulate a three way ANOVA and generate a matrix design which will include three independent variables (independent variable 1,2 and 3). The simulated independent variables can have different number of levels as well as effect sizes for every main effect as well as interaction. The sim.anova function can also simulate one or multiple dependent variables. Since psychological research requires lots of time as well as resources, the sim.anova function is a very useful tool that enables a researcher to simulate and inspect data prior to conducting an actual experiment. In this tutorial I will demonstrate how to generate an analysis of variance with three independent variables, I will also demonstrate how to produce an output of an ANOVA table, and lastly how to use a ggplot2 package to plot the means. 

## Install ("psych")

The first step to simulating data is to make sure that you have installed a "psych" package. This can be done in the packages window.

### Creating simulated data for three way ANOVA

The fist step in creating a simulated data for 3-way ANOVA is to create a data frame function (data.df), this is where your sim.anova function will be placed (data.df <- sim.anova). Since the sim.anova function can contain different arguments such as the effect size as well as different levels of independent variables, the first step is to identify these different arguments. The effect sizes are identified as "es1" "es2" and es3 for the effect size of the first, second and third  independent variable. The argument n stands for the sample size in each cell. The argument n1, n2 and n3 stand for numbers of levels in the independent variables one, two and three. By default the sim.anova function sets the effect sizes to zero, and levels in each independent variables to 2. All simulations will be a between subject designs. If you are interested in the 



```{r}
data.df <- sim.anova()  
describe(data.df)

```
In the above example we generated a 3 way ANOVA, where by default all of the effect sizes are zero for all independent variables and by default there are 2 levels in each independent variable. Also by default the sample size per cell is 2, since there are a total of 8 cells the n=16 as seen above.


```{r}
data.df <- sim.anova(es1=1, es2 = 0, es3 = 3)  
describe(data.df)

```

In the above example we manipulated the effect sizes for independent variabl 1,2 and 3

```{r}
data.df <- sim.anova(es1=1, es2 = 0, es3 = 3, es12 = 2, es13 = 2)  
describe(data.df)

```
In the above example we also manipulated the effect sizes of the interaction between independent variable 1 and 2 (es12), as well as the effect size for interaction between IV1 and IV2

```{r}
data.df <- sim.anova(es1=1, es2 = 0, es3 = 3, es12 = 2, es13 = 2, n=3)  
describe(data.df)

```

The above example was manipulated to have a cell sample size equal to 3 (n=3)

```{r}
data.df <- sim.anova(es1=1, es2 = 0, es3 = 3, es12 = .5, es13 = 2, n1=3, n2=4, n3=5)  
describe(data.df)

```

By manipulating the levels in each independent variable in the above example to n1=3, n2=4, n3=5; we can see that the sample size in each independent variable increased to 120.

## Producing an ANOVA table

It is very useful to see the results of the 3 way ANOVA simulation in the table. To do so in the code below we will create an ANOVA tabble by using the "aov" or the "lm" function.
Let's take a look at an example below


```{r}
summary(aov(DV~IV1*IV2*IV3,data=data.df)) 

```

In the above example we first incorporated a "summary" function, which is used to generate summaries of various statistical models, the "aov" function enables one to generate a succinc description of the ANOVA table which includes degrees of freedom, sum of squares, mean squares, F values, and the probabilities of the F values. The table summary is very usefull as one can inspect which independent variables as well as interactions are statistically significant.



```{r}
summary(lm(DV~IV1*IV2*IV3,data=data.df)) #compare with the aov model

```

The "aov" function is not the only function to generate an ANOVA table. The "aov" function is a subset of an "lm" function. As seen in the above example the "lm" function gives more comprehensive breakdown of the the 3 way anova simulation.

## Graphing the means of using ggplot2 function 

ggplot2 function is a very usefull function as it enabbles one to visualize your data. The examples below will illustrate how to graph the means of the independent variables.

The first step in graphing the means is to first isolate the column under the title "mean". To do we have to use the "describe" function, which summarizes basic statistics. By using square brackets [,] we can isolate the exact column in our data frame. In the example below we are interested in means which fall under the 3rd column. by using [,3] we are able to isolate the 3rd column

```{r}
describe(data.df)[,3]
```

The example above illustrates the generated means. The next step is to insert the means into a new variable, in the example below that variable is "means_variable"

```{r}
means_variable <- describe(data.df)[,3]
```

The example above created our new variable with the independent variable means as well as dependent variable mean, and is stored in the 'Global Environment




```{r}
library(ggplot2)
variables <- rep(as.factor(c("IV1","IV2","IV3","DV"))) 
Means <- means_variable

plot_df <- data.frame(variables,
                  
                      Means)

# basic bar graph

ggplot(plot_df, aes(x=variables,y=Means, # aestetics definition has gotten 
                   # color=factor_two))+  # color here means the border collor
                   ))+
  geom_bar(stat="identity", 
           position="dodge",
           color="red")

```



```{r}
library(ggplot2)
variables <- rep(as.factor(c("IV1","IV2","IV3","DV"))) 
Means <- c(2, 2.5, 3, -0.107)

plot_df <- data.frame(variables,
                  
                      Means)

# basic bar graph

ggplot(plot_df, aes(x=variables,y=Means, # aestetics definition has gotten 
                   # color=factor_two))+  # color here means the border collor
                   ))+
  geom_bar(stat="identity", 
           position="dodge",
           color="red")

```


## Citations

J. Cohen (1982) Set correlation as a general multivariate data-analytic method. Multivariate Behavioral Research, 17(3):301-341.

J. Cohen, P. Cohen, S.G. West, and L.S. Aiken. (2003) Applied multiple regression/correlation analysis for the behavioral sciences. L. Erlbaum Associates, Mahwah, N.J., 3rd ed edition.

H. Hotelling. (1936) Relations between two sets of variates. Biometrika 28(3/4):321-377. E.Cramer and W. A. Nicewander (1979) Some symmetric, invariant measures of multivariate association. Psychometrika, 44:43-54.

V. D. R. Guide Jr. and M. Ketokivim (2015) Notes from the Editors: Redefining some methodological criteria for the journal. Journal of Operations Management. 37. v-viii

```{r}
library(psych)
sim.anova(es1 = 0, n = 2,n1 = 2, 
    within=NULL,factors=TRUE,center = TRUE,std=TRUE)
```


```{r}
sim.anova(es1 = 0, es2 = 0, es3 = 0, es12 = 0, es13 = 0,
    es23 = 0, es123 = 0, es11=0,es22=0, es33=0,n = 2,n1 = 2, n2 = 2, n3 = 2, 
    within=NULL,r=.8,factors=TRUE,center = TRUE,std=TRUE)
```




```{r}
summary(aov(DV~IV1*IV2*IV3,data=data.df)) #compare with the lm model

```


```{r}
library(ggplot2)
ggplot(data.df)
ggplot(data = data.df, aes(", n, ")) 
  
```






```{r}
data.df <- sim.anova(es1=1, es2 = .5, es13 = 1)  # one main effect and one interaction
describe(data.df)
pairs.panels(data.df)
summary(aov(DV~IV1*IV2*IV3,data=data.df)) #compare with the lm model

```

```{r}
data.df <- sim.anova(es1=1, es2 = .5, es13 = 1)  # one main effect and one interaction
describe(data.df)
pairs.panels(data.df)
summary(lm(DV~IV1*IV2*IV3,data=data.df))

summary(aov(DV~IV1*IV2*IV3,data=data.df)) #compare with the lm model

```





```{r}
data.df <- sim.anova(es1=1, es2 = .5, es123 = 1)  # one main effect and one interaction
describe(data.df)
pairs.panels(data.df)
```

```{r}
data.df <- sim.anova(es1=1, es2 = .5, es123 = 1, n=5, n1=2, n2=2, n3=2)  # one main effect and one interaction
describe(data.df)
pairs.panels(data.df)
```



```{r}
data.df <- sim.anova(es1=1, es2 = .5, es123 = 1, within=c(-1,0,1),n=10) # one main effect and one interaction
describe(data.df)
pairs.panels(data.df)

```

```{r}
summary(aov(DV~IV1*IV2*IV3,data=data.df))

summary(aov(DV~IV1*IV2*IV3,data=data.df)) #compare with the lm model

```


